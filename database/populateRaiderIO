/**
 * Function populateRaiderIO: Takes in data from the spreadsheet and populates the MythicPlus table in the database
 */
function populateRaiderIO(){
// Sets the current data in Date format 
  var currentDate = new Date().toISOString().slice(0, 19).replace('T', ' ');

  // Creates a statement and sets it equal to stmt
  var stmt = conn.createStatement();

  // While the row (x) and first columns value is not empty
  while (activeSheet.getRange(x, 1).getValue() != "") {

  // Sets characterName equal to the row (x) and the first columns value
  var characterName = "'" + activeSheet.getRange(x, 1).getValue() + "'";

  // Sets weeklyHighest equal to the row (x) and the eleventh columns value
  var weeklyHighest = "'" + activeSheet.getRange(x, 11).getValue() + "'";

  // Sets totalKeys equal to the row (x) and the twelfth columns value
  var totalKeys = "'" + activeSheet.getRange(x, 12).getValue() + "'";

  // Sets score equal to the row (x) and the thirteenth columns value
  var score = "'" + activeSheet.getRange(x, 13).getValue() + "'";

  // Sets currentDates equal to the currentDate 
  var currentDates = "'" + currentDate + "'";

  // Creates an SQL statement to insert into the MythicPlus table 
  var sql = "INSERT INTO MythicPlus(characterID, weeklyHighest, totalKeys, score, lastUpdate) SELECT characterID" + ', ' + weeklyHighest + ', ' + totalKeys +  ', ' + score + ', ' + currentDates + " FROM Characters WHERE name=" + characterName;

    // Executes the SQL statement
    stmt.execute(sql, 1);

    //Gets the generated keys 
    var rs = stmt.getGeneratedKeys();

    // Increments the row (x)
    x++;
 }
  // Closes the connections
  rs.close();
  stmt.close();
  conn.close();
}
